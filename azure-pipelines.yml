trigger:
  branches:
    include:
      - main  # Adjust to your default branch

pool:
  name: 'Demo'


stages:
- stage: Build
  displayName: 'Setup Environment'
  jobs:
  - job: Build
    steps:
    - checkout: self

    - script: |
        python3 -m venv venv
        source venv/bin/activate
        pip install -r requirements.txt
      displayName: 'Setup Python Environment & Install Dependencies'

- stage: Test
  displayName: 'Run Robot Framework Tests'
  dependsOn: Build
  jobs:
  - job: Test
    steps:
    - script: |
        source venv/bin/activate
        robot -d results tests/
      displayName: 'Run Tests'

- stage: Deploy
  displayName: 'Deploy or Save Artifacts'
  dependsOn: Test
  condition: succeeded()
  jobs:
  - job: Deploy
    steps:
    - publish: $(System.DefaultWorkingDirectory)/results
      artifact: test-results
      displayName: 'Save Test Results'

